---
title: "HW4_Novikov"
output: html_document
date: "2024-04-03"
---

## Задание 1 (2 балла)

```{r}
# Устанавливаем seed для воспроизводимости результатов
set.seed(123)

# Задаем размер выборки
sample_size <- 30

# Задаем значения среднего артериального давления до и после приема препарата
before <- rnorm(sample_size, mean = 150, sd = 10)
after <- rnorm(sample_size, mean = 140, sd = 10)

# Формулируем нулевую и альтернативную гипотезы
# H0: Среднее артериальное давление до приема препарата равно среднему давлению после
# Ha: Среднее артериальное давление до приема препарата больше, чем среднее давление после

# Определяем уровень значимости
alpha <- 0.05

# Выбираем статистический тест для проверки гипотезы
# Так как мы сравниваем средние значения до и после приема препарата на одной и той же группе пациентов,
# мы используем одновыборочный t-тест.

# Выполняем тест
t_result <- t.test(before, after, alternative = "greater")

# Оцениваем статистическую значимость
p_value <- t_result$p.value
statistic <- t_result$statistic
critical_value <- qt(1 - alpha, df = sample_size - 1)

# Выводим результаты
cat("Наблюдаемое значение статистики:", statistic, "\n")
cat("Критическое значение статистики:", critical_value, "\n")
cat("Статистическая значимость (p-value):", p_value, "\n")

# Прокомментируем статистическую значимость
if (p_value < alpha) {
  cat("Отвергаем нулевую гипотезу в пользу альтернативной.\n")
} else {
  cat("Нет достаточных доказательств для отвержения нулевой гипотезы.\n")
}
```

В данном коде мы создаем выборки для артериального давления до и после приема препарата, формулируем гипотезы, выбираем статистический тест (одновыборочный t-тест), проводим тест и оцениваем статистическую значимость.

Из результатов теста видно, что наблюдаемое значение статистики (3.292902) превышает критическое значение статистики (1.699127), а также p-value (0.0008565572) меньше уровня значимости (0.05). Это означает, что мы отвергаем нулевую гипотезу в пользу альтернативной. Таким образом, есть статистические доказательства того, что среднее артериальное давление после приема нового препарата в среднем значительно ниже, чем до приема препарата.

## Задание 2 (2 балла)

```{r}
# Задаем размеры выборок
sample_size1 <- 100
sample_size2 <- 30

# Задаем вероятности заболеть раком легких для курящих и некурящих
prob_smokers <- 0.8
prob_non_smokers <- 0.2

# Генерируем данные по курению с соотношением 1:1
smokers <- rep(1, sample_size1)
non_smokers <- rep(0, sample_size2)

# Объединяем данные
data <- c(smokers, non_smokers)

# Формулируем нулевую и альтернативную гипотезы
# H0: Нет связи между курением и развитием рака легких
# Ha: Существует связь между курением и развитием рака легких

# Определяем уровень значимости
alpha <- 0.05

# Выбираем статистический тест для проверки гипотезы
# Так как мы хотим проверить связь между двумя категориальными переменными (курение и развитие рака легких), 
# мы используем тест на независимость категорий (например, хи-квадрат).

# Выполняем тест
contingency_table <- table(data)
chi_sq_result <- chisq.test(contingency_table)

# Оцениваем статистическую значимость
p_value <- chi_sq_result$p.value
statistic <- chi_sq_result$statistic
critical_value <- qchisq(1 - alpha, df = length(contingency_table) - 1)

# Выводим результаты
cat("Наблюдаемое значение статистики:", statistic, "\n")
cat("Критическое значение статистики:", critical_value, "\n")
cat("Статистическая значимость (p-value):", p_value, "\n")

# Прокомментируем статистическую значимость
if (p_value < alpha) {
  cat("Отвергаем нулевую гипотезу в пользу альтернативной.\n")
} else {
  cat("Нет достаточных доказательств для отвержения нулевой гипотезы.\n")
}
```

В данном коде мы генерируем данные о курении и развитии рака легких для двух выборок разного размера, формулируем гипотезы, выбираем статистический тест (тест на независимость категорий - хи-квадрат), проводим тест и оцениваем статистическую значимость.

Результаты теста показывают, что наблюдаемое значение статистики (37.69231) значительно превышает критическое значение статистики (3.841459) при уровне значимости 0.05. Кроме того, p-value очень близко к нулю (8.283055e-10), что гораздо меньше выбранного уровня значимости. Таким образом, у нас есть достаточные доказательства для отвержения нулевой гипотезы в пользу альтернативной. Это означает, что существует связь между курением и развитием рака легких в выборке.

## Задание 3 (3 балла)

```{r}
# Формулируем нулевую и альтернативную гипотезы
# H0: Применение нового метода лечения не влияет на уровень болевых симптомов синдрома раздраженного кишечника
# Ha: Применение нового метода лечения значимо меняет уровень болевых симптомов синдрома раздраженного кишечника

# Определяем уровень значимости
alpha <- 0.05

# Выбираем статистический тест для проверки гипотезы
# Учитывая, что мы сравниваем уровни болевых симптомов в двух независимых группах, 
# можем использовать двухвыборочный t-тест для независимых выборок.

# Генерируем данные
set.seed(123)
group1 <- rnorm(30, mean = 50, sd = 10)  # данные для группы с новым методом лечения
group2 <- rnorm(30, mean = 55, sd = 10)  # данные для группы с диетотерапией

# Выполняем тест
t_result <- t.test(group1, group2)

# Оцениваем статистическую значимость
p_value <- t_result$p.value
statistic <- t_result$statistic
critical_value <- qt(1 - alpha/2, df = length(group1) + length(group2) - 2)  # используем двухсторонний тест

# Выводим результаты
cat("Наблюдаемое значение статистики:", statistic, "\n")
cat("Критическое значение статистики (двухсторонний тест):", critical_value, "\n")
cat("Статистическая значимость (p-value):", p_value, "\n")

# Прокомментируем статистическую значимость
if (abs(statistic) > critical_value) {
  cat("Отвергаем нулевую гипотезу в пользу альтернативной.\n")
} else {
  cat("Нет достаточных доказательств для отвержения нулевой гипотезы.\n")
}
```

В данном коде мы формулируем гипотезы, выбираем уровень значимости, статистический тест (двухвыборочный t-тест для независимых выборок), генерируем данные, проводим тест и оцениваем статистическую значимость. Также учитываем, что мы используем двухсторонний тест, так как интересует любое отклонение от нулевой гипотезы, а не только одностороннее.

Исходя из результатов:

Наблюдаемое значение статистики (-3.084094) значительно превышает критическое значение статистики (2.001717) при уровне значимости 0.05, а также имеет низкое p-значение (0.00315574), что указывает на статистическую значимость различий между группами. Следовательно, мы отвергаем нулевую гипотезу в пользу альтернативной. Это означает, что применение нового метода лечения синдрома раздраженного кишечника значимо меняет уровень болевых симптомов по сравнению с группой, прошедшей лечение диетотерапией.

## Задание 4 (4 балла)

```{r}
# Загрузим необходимые библиотеки
library(tibble)
library(dplyr)
library(ggplot2)

# Создадим датасет
tumor <- tibble(
  therapy = c(rep("0", 10), rep("A", 10), rep("B", 10)),
  value = c(rep(3213, 10), rep(2687, 10), rep(2423, 10))
) %>%
  mutate(therapy = factor(therapy, levels = c("0", "A", "B")))
tumor$value <- tumor$value + rnorm(30, 0, 760)

# Построим "ящики с усами" для наглядности
ggplot(tumor, aes(x = therapy, y = value, fill = therapy)) +
  geom_boxplot() +
  labs(title = "Размер опухоли в различных группах",
       x = "Препарат",
       y = "Размер опухоли") +
  theme_minimal()

# Проведем дисперсионный анализ
anova_result <- aov(value ~ therapy, data = tumor)
summary(anova_result)

# Проведем попарные сравнения с помощью критерия Тьюки
tukey_result <- TukeyHSD(anova_result)
tukey_result
```

Результаты дисперсионного анализа показывают, что фактор "therapy" (препараты) оказывает статистически значимое влияние на размер опухоли (F(2, 27) = 5.115, p = 0.0131).

Далее, проведены попарные сравнения с помощью критерия Тьюки. Результаты показывают следующее:

-   Препарат A значимо отличается от плацебо (0) по размеру опухоли (p = 0.0121).

-   Препарат B также показывает значимое различие с плацебо (0) (p = 0.0833), хотя уровень значимости не достигает уровня 0.05.

-   Между препаратами A и B не обнаружено статистически значимой разницы по размеру опухоли (p = 0.6668).

Таким образом, можно сделать вывод, что препарат A имеет значимый эффект по сравнению с плацебо, а препарат B показывает тенденцию к уменьшению размера опухоли, но статистическая значимость не достигнута на уровне 0.05.
